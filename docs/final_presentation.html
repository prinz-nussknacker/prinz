<!DOCTYPE html>
<html>
<head>
    <title>Prinz - Integrating Nussknacker with selected Machine Learning tools</title>
    <meta charset="utf-8">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Quicksand:wght@300;400;500;600;700&display=swap');

        body {
            font-family: 'Quicksand';
            color: #0013a0;
        }
        h1, h2, h3, h4, h5 {
            font-family: 'Quicksand';
            font-weight: bold;
            color: #0013a0;
        }
        img {
            max-width: 100%;
            max-height: 100%;
        }
        .remark-code, .remark-inline-code {
            font-family: 'Ubuntu Mono';
        }
        .right-half {
            width: 50%;
            float: right;
        }
        .left-half {
            width: 50%;
            float: left;
        }
        .left-2-5 {
            margin-left: 10%;
            width: 40%;
            float: left;
        }
        .centered-flex {
            display: flex;
            width: 100%;
            flex-direction: row;
            align-items: center;
            justify-content: center;
        }

        #mlflow-logo {
            display: block;
            margin: 3em auto 3em;
            height: 6em;
        }

        #mlflow-repository {
            display: block;
            margin: 1em auto 1em;
            height: 16em;
        }

    </style>
</head>
<body>
<textarea id="source">

class: center, middle

<img src="./images/prinz-logo.svg" style="height: 16em">
# "Integrating Nussknacker with selected Machine Learning tools"

---

## Agenda

.left-half[

- Introduction

 1.1 Source of problem

 1.2 Available tools

 1.3 Our mission
]

--

.left-half[

- Implementation

 2.1 Prinz API

 2.2 MLflow implementation

 2.3 PMML implementation

 2.4 H2O implementation

 2.5 Prepared examples
]

--

.left-half[

- Technical aspects of project

 3.1 Environment for development

 3.2 Project management

 3.3 Final results
]

---

## Introduction

Let's see the [first presentation source](https://prinz-nussknacker.github.io/prinz/presentation.html)
for the examples how to add presentation pages.

---

## MLflow - integration overview

<img id="mlflow-logo" src="./images/mlflow-logo.svg" alt="MLflow logo" title="MLflow logo" />

- project to manage the complete ML models lifecycle

- open-source and open-interface approach to project

- well documented library API

- ML models management (with user friendly Web UI)

- ML models serving

---

## Models lifecycle in prepared environment

1. Configure and set up the MLflow models registry with DB and extra services

2. Train small, toy models and add them to the models registry

3. Serve trained models as service

4. Score trained models from Prinz in Nussknacker

## Extra assumptions

- models trained with signature saved to storage service (S3 bucket)

- served models location depends on the name and version of the model

- models outputs indexing

---

## Models Repository

- based on open source scala HTTP client (`sttp`)

- implementation of MLflow REST API from scratch

- heavy use of Scala `circe` library with `@JsonCodec` approach

- parametrized with external configuration

<img id="mlflow-repository" src="./images/mlflow-run-list.png" alt="MLflow repository" />

---

## Model and Model' Instance

- listed from JSON response from MLflow registry

- models' signatures downloaded from external service

- models converted to instances capable of scoring external service

- need of i/o data conversion

.left-half[

```
my_model/
```
```
- MLmodel
- model.pkl
```

]

.right-half[

```
MLmodel:
```

```yaml
time_created: 2020-12-20T17:28:53.35

flavors:
 sklearn:
 sklearn_version: 0.19.1
 pickled_model: model.pkl
 python_function:
 loader_module: mlflow.sklearn
```

]

---

## Model Signature

- created during training by Data Scientists

- available on external storage service as YAML file

- downloaded once per model loading process

- automatic parse process with strict typing approach

```yaml
signature:
 inputs: >
 [
 {"name": "age", "type": "string"},
 {"name": "gender", "type": "string"},
 {"name": "category", "type": "string"},
 {"name": "amount", "type": "double"}
 ]
 outputs: >
 [
 {"type": "integer"}
 ]
```

---

## PMML

---

## H2O

---

## Technical aspects of project

 </textarea>
<script src="https://remarkjs.com/downloads/remark-latest.min.js">
</script>
<script>
    var slideshow = remark.create();
</script>
</body>
</html>
